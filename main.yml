#!/usr/bin/env ansible-playbook

---
- name: Configure workstation
  hosts: localhost
  vars:
    common_packaged_apps:
      - ansible
      - bat
      - bottom
      - calibre
      - drawio
      - fd
      - fish
      - firefox
      - git
      - gitui
      - git-filter-repo
      - inkscape
      - jq
      - lsd
      - neovim
      - pdm
      - pipx
      - python
      - ripgrep
      - tmux
      - tealdeer
      - zoxide
    different_apps:
      - 1password
      - emacs
      - fd
      - iterm2
      - onedrive
      - util-linux-user
      - font-hack-nerd-font

  vars_prompt:

    - name: update_install
      prompt: "Update & Install packages (requires -K flag)? [yes | no]"
      default: "no"

    - name: global_git
      prompt: "Link global git settings with personal email address? [yes | no]"
      default: "no"

  tasks:
    - name: Update & Install packages
      when:
        - update_install == "true"
        - ansible_become_password
      ansible.builtin.include_tasks:
        file: "tasks/update_install.yml"

    - name: Tasks for unix-like operating systems
      when: ansible_facts.distribution != "Windows"
      ansible.builtin.include_tasks:
        file: "tasks/Unix_likes.yml"

    - name: Fedora tasks
      when: ansible_facts.distribution == "Fedora"
      ansible.builtin.include_tasks:
        file: "tasks/Fedora.yml"

    - name: WSL2 Fedora tasks
      when:
        - ansible_facts.distribution_file_variety is defined
        - ansible_facts.distribution_file_variety == "RedHat"
        - ansible_facts.distribution == "Generic" # Dunno why they used this
      ansible.builtin.include_tasks:
        file: "tasks/Fedora.yml"

    - name: MacOS tasks
      when: ansible_facts.distribution == "MacOSX"
      ansible.builtin.include_tasks:
        file: "tasks/MacOS.yml"
