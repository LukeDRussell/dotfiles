#!/usr/bin/env ansible-playbook

---
- name: Configure workstation
  hosts: localhost
  vars:
    common_packaged_apps:
      - ansible
      - bat
      - bottom
      - calibre
      - drawio
      - fish
      - firefox
      - git
      - gitui
      - git-filter-repo
      - inkscape
      - jq
      - lsd
      - neovim
      - pdm
      - pipx
      - python
      - ripgrep
      - tmux
      - tealdeer
      - zoxide
    brew_apps:
      - emacs-plus@29
      - fd
      - font-hack-nerd-font
      - cmake
    brew_casks:
      - 1password
      - iterm2
      - onedrive
    fedora_apps:
      - 1password
      - fd-find
      - emacs
      - util-linux-user

  vars_prompt:

    - name: update_install
      prompt: "Update & Install packages (requires -K flag)? [yes | no]"
      default: "no"

    - name: global_git
      prompt: "Link global git settings with personal email address? [yes | no]"
      default: "no"

  tasks:

    - name: Fedora tasks
      when: ansible_facts.distribution == "Fedora"
      ansible.builtin.include_tasks:
        file: "tasks/Fedora.yml"

    - name: WSL2 Fedora tasks
      when:
        - ansible_facts.distribution_file_variety is defined
        - ansible_facts.distribution_file_variety == "RedHat"
        - ansible_facts.distribution == "Generic" # Dunno why they used this
      ansible.builtin.include_tasks:
        file: "tasks/Fedora.yml"

    - name: MacOS tasks
      when: ansible_facts.distribution == "MacOSX"
      ansible.builtin.include_tasks:
        file: "tasks/MacOS.yml"

    - name: Configs for all unix-like OSs
      when: ansible_facts.distribution != "Windows"
      ansible.builtin.include_tasks:
        file: "tasks/Unix_likes.yml"
